<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Defend Dad â€” Donation Tracker</title>
<link rel="stylesheet" href="/assets/tools/global.css">
<style>
  /* Slim progress bar */
  .dd-bar-wrap{position:relative;padding:20px 16px}
  .dd-bar{
    height:12px;  /* thinner */
    border:1px solid var(--line);
    background:#0b0e13;
    border-radius:14px;
    overflow:hidden;
  }
  .dd-fill{
    position:absolute;inset:0 0 0 0;width:0%;
    background:linear-gradient(90deg,var(--gold),#f6d773);
    transition:width .8s ease;
  }

  /* Mascots */
  .dd-push-dad{
    position:absolute;left:-4px;bottom:-16px;
    height:50px;pointer-events:none;user-select:none;
  }
  .dd-kids{
    position:absolute;right:-4px;bottom:-12px;
    height:46px;pointer-events:none;user-select:none;
  }
  .dd-coin-dad-link{
    position:absolute;left:46%;top:-10px;transform:translate(-50%,-50%);display:block;
  }
  .dd-coin-dad{
    height:50px;display:block;
    filter:drop-shadow(0 6px 8px rgba(0,0,0,.25));
    transition:transform .2s ease;
  }
  .dd-coin-dad-link:hover .dd-coin-dad{ transform:translateY(-2px) }

  /* Goal marker dad */
  .dd-goal-dad{
    position:absolute;bottom:22px;
    height:42px;transform:translateX(-50%);left:0%;
    transition:left .8s cubic-bezier(.22,.8,.26,1);
    pointer-events:none;
  }

  /* Milestone ticks */
  .dd-ticks{
    position:relative;height:48px;margin-top:10px;font-size:.9rem;color:var(--muted);
    z-index:1; pointer-events:none;
  }
  .dd-tick{
    position:absolute;top:0;transform:translateX(-50%);
    text-align:center;white-space:nowrap;
  }
  .dd-tick::before{
    content:"";position:absolute;left:50%;top:-12px;transform:translateX(-50%);
    width:1px;height:12px;background:#2b3442;
  }
  .dd-amt{display:block;color:var(--ink);font-weight:800}
  .dd-lbl{display:block;color:var(--muted);max-width:140px}

  .dd-hint{margin-top:14px;color:var(--muted);font-size:1rem}
  .gold{color:var(--gold)}

  .dd-cta{ margin-top:12px;text-align:center }
  .dd-cta a{
    display:inline-block;background:var(--purple);color:#fff;text-decoration:none;
    padding:8px 12px;border-radius:10px;font-weight:800;
    box-shadow:0 8px 18px rgba(91,61,245,.22);
  }
  .dd-cta a:hover{ filter:brightness(1.06) }
</style>
</head>
<body>
<div class="dd-wrap">

  <div class="dd-panel" id="dd-tracker">
    <h2 class="title">On Our Way to the Next Milestone</h2>

    <div class="meta">
      <div>Raised: <span class="pill raised" id="raised-pill">$0</span></div>
      <div>Total Goal: <span class="pill" id="goal-pill">$0</span></div>
    </div>

    <div class="dd-bar-wrap">
      <!-- coin dad -->
      <a class="dd-coin-dad-link" href="/storefront/index.html" title="Support Defend Dad">
        <img class="dd-coin-dad"
             src="/assets/Image/dad-coins.png"
             alt="Dad dropping coin (click to support)"/>
      </a>

      <!-- push dad -->
      <img class="dd-push-dad"
           src="/assets/Image/dad-push.png"
           alt="Dad pushing progress"/>

      <div class="dd-bar" aria-label="Goal progress"><div class="dd-fill" id="fill"></div></div>

      <!-- kids -->
      <img class="dd-kids"
           src="/assets/Image/team-dad-kids.png"
           alt="Kids cheering"/>

      <!-- goal marker -->
      <img class="dd-goal-dad" id="goal-dad"
           src="/assets/Image/dad-goal.png"
           alt="Goal marker"/>
    </div>

    <!-- Milestones -->
    <div class="dd-ticks" id="ticks"></div>

    <!-- CTA -->
    <div class="dd-cta">
      <span class="dd-hint">ðŸ’ª Want to push us forward?</span>
      &nbsp;<a href="/storefront/index.html">Donate or Shop â†’</a>
    </div>

    <p class="dd-hint" style="margin-top:10px">
      Defend Dad is building practical tools so everyday dads are treated fairly with their kids.
      Donations cover development, hosting and tools only. <span class="gold">Thank you.</span>
    </p>
  </div>

</div>

<script>
(async function init(){
  const fill    = document.getElementById('fill');
  const raisedP = document.getElementById('raised-pill');
  const goalP   = document.getElementById('goal-pill');
  const ticks   = document.getElementById('ticks');
  const goalDad = document.getElementById('goal-dad');

  const usd = n => '$' + Number(n||0).toLocaleString('en-US',{maximumFractionDigits:0});

  // Load live numbers
  let data = {raised:0, goalTotal:1, milestones:[]};
  try{
    const res = await fetch('/assets/tools/current-donations.json?cb=' + Date.now());
    data = await res.json();
  }catch(e){ console.warn('donations.json fetch failed', e); }

  const RAISED = Number(data.raised||0);
  const GOAL   = Math.max(1, Number(data.goalTotal||0));
  const M      = Array.isArray(data.milestones) ? data.milestones : [];

  raisedP.textContent = usd(RAISED);
  goalP.textContent   = usd(GOAL);

  // Progress
  requestAnimationFrame(()=>{
    const pct = Math.max(0, Math.min(100, (RAISED/GOAL)*100));
    fill.style.width = pct + '%';
  });

  // Ticks
  ticks.innerHTML = '';
  M.forEach(ms=>{
    const p = Math.min(100, (ms.amount/GOAL)*100);
    const el = document.createElement('div');
    el.className = 'dd-tick';
    el.style.left = p + '%';
    el.title = ms.label + ' â€” ' + usd(ms.amount);
    el.innerHTML = `<span class="dd-amt">${usd(ms.amount)}</span><span class="dd-lbl">${ms.label}</span>`;
    ticks.appendChild(el);
  });

  // Goal-dad snaps to last completed milestone
  let last = {amount:0, label:''};
  for(const ms of M){ if(ms.amount <= RAISED){ last = ms; } else { break; } }
  const gp = Math.min(100, (last.amount/GOAL)*100);
  goalDad.style.left = gp + '%';
  goalDad.title = last.label ? `Reached: ${last.label} (${usd(last.amount)})` : 'Getting started';
})();
</script>
</body>
</html>
